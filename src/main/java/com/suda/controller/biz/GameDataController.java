package com.suda.controller.biz;

import com.alibaba.fastjson.JSON;
import com.google.gson.Gson;
import com.alibaba.fastjson.JSONObject;
import com.suda.http.api.RequestCallBack;
import com.suda.http.api.tencent.TencentService;
import com.suda.http.bean.match.MatchStat;
import com.suda.service.LiveService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpRequest;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.UnsupportedEncodingException;

/**
 * Created by ES-BF-IT-126 on 2018/1/2.
 */

@Controller
@RequestMapping(value = "/gamedata")
public class GameDataController {
    @Autowired
    private LiveService liveService;
    @RequestMapping(value = "/matchStat", method = {RequestMethod.GET})
    @ResponseBody
    public JSONObject matchStat(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse,
                          @RequestParam(value = "mid", required = true) String mid,
                          @RequestParam(value = "tabType", defaultValue = "2") String tabType,
                          @RequestParam(value = "homeTeamName", defaultValue = "") String homeTeamName,
                          @RequestParam(value = "guestTeamName", defaultValue = "") String guestTeamName
                          ){
        //TODO 此处由于没有NBA比赛，所以用 json串代替测试
        String homeStr = null;
        String guestStr = null;
        try {
            homeStr = new String(homeTeamName.getBytes("iso-8859-1"), "utf-8");
            guestStr = new String(guestTeamName.getBytes("iso-8859-1"), "utf-8");
        } catch (UnsupportedEncodingException e) {
            System.out.println("3434");
            e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
        }
        //JSONObject jsonObject = liveService.getMatchState(mid, tabType, "独行侠", "灰熊");
        System.out.println(homeStr);
        System.out.println(guestStr);
        JSONObject jsonObject = liveService.getMatchState(mid, tabType, homeStr, guestStr);
        //String str = "{\"code\":0,\"data\":{\"livePeriod\":\"\",\"mid\":\"100000:1471298\",\"matchSourceList\":[{\"liveSource\":2,\"sourceName\":\"QQ高清\",\"sourceValue\":\"https://d5a5b3dd1ccb90d30360f0c068fd43fc.oss-cn-shanghai.aliyuncs.com/w.html?id=http%3a%2f%2fhdl50000.plures.net%2fonlive%2fc291f058f6c441009926f265f7b3d894.m3u8%3ftxSecret%3d711c0aef64ebeee7f5d1987762df7d5b%26txTime%3d5aa32dcd\"},{\"liveSource\":3,\"sourceName\":\"QQ高清2\",\"sourceValue\":\"https://d5a5b3dd1ccb90d30360f0c068fd43fc.oss-cn-shanghai.aliyuncs.com/w.html?id=http%3a%2f%2fhdl50000.plures.net%2fonlive%2fc291f058f6c441009926f265f7b3d894.m3u8%3ftxSecret%3d711c0aef64ebeee7f5d1987762df7d5b%26txTime%3d5aa32dcd\"}],\"stats\":[{\"playerStats\":[{\"subText\":\"球员统计-凯尔特人\"},{\"head\":[\"球员\",\"时间\",\"得分\",\"篮板\",\"助攻\",\"抢断\",\"盖帽\",\"投篮\",\"投篮%\",\"三分\",\"三分%\",\"罚球\",\"罚球%\",\"前板\",\"后板\",\"失误\",\"犯规\",\"+/-\"]},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=4840\",\"onCrt\":\"0\",\"playerId\":\"4840\",\"row\":[\"欧文\",\"29:35\",\"23\",\"7\",\"8\",\"2\",\"1\",\"9/15\",\"60.0%\",\"3/7\",\"42.9%\",\"2/2\",\"100.0%\",\"1\",\"6\",\"4\",\"2\",\"5\"],\"started\":\"1\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=4245\",\"onCrt\":\"0\",\"playerId\":\"4245\",\"row\":[\"霍福德\",\"34:14\",\"20\",\"8\",\"6\",\"0\",\"1\",\"8/14\",\"57.1%\",\"1/4\",\"25.0%\",\"3/3\",\"100.0%\",\"1\",\"7\",\"1\",\"1\",\"13\"],\"started\":\"1\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=1962937413\",\"onCrt\":\"0\",\"playerId\":\"1962937413\",\"row\":[\"杰伦-布朗\",\"28:09\",\"14\",\"5\",\"0\",\"0\",\"0\",\"4/10\",\"40.0%\",\"1/2\",\"50.0%\",\"5/5\",\"100.0%\",\"3\",\"2\",\"0\",\"0\",\"12\"],\"started\":\"1\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=1962937724\",\"onCrt\":\"0\",\"playerId\":\"1962937724\",\"row\":[\"塔图姆\",\"22:11\",\"12\",\"5\",\"0\",\"0\",\"0\",\"4/8\",\"50.0%\",\"1/4\",\"25.0%\",\"3/4\",\"75.0%\",\"1\",\"4\",\"1\",\"3\",\"-11\"],\"started\":\"1\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=5150\",\"onCrt\":\"0\",\"playerId\":\"5150\",\"row\":[\"贝恩斯\",\"10:28\",\"6\",\"4\",\"1\",\"0\",\"0\",\"3/6\",\"50.0%\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"4\",\"0\",\"3\",\"-11\"],\"started\":\"1\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=4895\",\"onCrt\":\"0\",\"playerId\":\"4895\",\"row\":[\"马库斯-莫里斯\",\"32:35\",\"17\",\"5\",\"2\",\"0\",\"0\",\"7/15\",\"46.7%\",\"3/5\",\"60.0%\",\"0/1\",\"0.0%\",\"1\",\"4\",\"0\",\"0\",\"16\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=5559\",\"onCrt\":\"0\",\"playerId\":\"5559\",\"row\":[\"罗齐尔\",\"24:18\",\"13\",\"4\",\"1\",\"2\",\"0\",\"5/10\",\"50.0%\",\"2/6\",\"33.3%\",\"1/1\",\"100.0%\",\"0\",\"4\",\"1\",\"2\",\"7\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=5317\",\"onCrt\":\"0\",\"playerId\":\"5317\",\"row\":[\"斯马特\",\"32:56\",\"9\",\"2\",\"6\",\"2\",\"0\",\"2/7\",\"28.6%\",\"0/4\",\"0.0%\",\"5/9\",\"55.6%\",\"2\",\"0\",\"2\",\"1\",\"15\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=4722\",\"onCrt\":\"0\",\"playerId\":\"4722\",\"row\":[\"门罗\",\"09:09\",\"2\",\"4\",\"2\",\"0\",\"0\",\"1/2\",\"50.0%\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"4\",\"1\",\"2\",\"3\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=1962937947\",\"onCrt\":\"0\",\"playerId\":\"1962937947\",\"row\":[\"丹尼尔-泰斯\",\"09:34\",\"1\",\"2\",\"2\",\"1\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"1/2\",\"50.0%\",\"0\",\"2\",\"1\",\"2\",\"-5\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=4724\",\"onCrt\":\"0\",\"playerId\":\"4724\",\"row\":[\"海沃德\",\"00:00\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"0\",\"0\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=1962937429\",\"onCrt\":\"0\",\"playerId\":\"1962937429\",\"row\":[\"亚布塞莱\",\"00:00\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"0\",\"0\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=1962937777\",\"onCrt\":\"0\",\"playerId\":\"1962937777\",\"row\":[\"伯德\",\"00:00\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"0\",\"0\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=1962937776\",\"onCrt\":\"0\",\"playerId\":\"1962937776\",\"row\":[\"卡迪姆阿伦\",\"00:00\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"0\",\"0\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=1962937752\",\"onCrt\":\"0\",\"playerId\":\"1962937752\",\"row\":[\"奥杰莱\",\"06:49\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"1\",\"-4\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=1962937466\",\"onCrt\":\"0\",\"playerId\":\"1962937466\",\"row\":[\"纳德\",\"00:00\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"0\",\"0\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=5188\",\"onCrt\":\"0\",\"playerId\":\"5188\",\"row\":[\"拉金\",\"00:00\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"0\",\"0\"],\"started\":\"0\"},{\"detailUrl\":\"\",\"onCrt\":\"0\",\"playerId\":\"\",\"row\":[\"统计\",\"\",\"117\",\"46\",\"28\",\"7\",\"2\",\"43/87\",\"49.4%\",\"11/32\",\"34.4%\",\"20/27\",\"74.1%\",\"9\",\"37\",\"11\",\"17\",\"-\"],\"started\":\"0\"},{\"subText\":\"球员统计-森林狼\"},{\"head\":[\"球员\",\"时间\",\"得分\",\"篮板\",\"助攻\",\"抢断\",\"盖帽\",\"投篮\",\"投篮%\",\"三分\",\"三分%\",\"罚球\",\"罚球%\",\"前板\",\"后板\",\"失误\",\"犯规\",\"+/-\"]},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=5509\",\"onCrt\":\"0\",\"playerId\":\"5509\",\"row\":[\"别利察\",\"40:21\",\"30\",\"12\",\"2\",\"0\",\"0\",\"11/16\",\"68.8%\",\"6/9\",\"66.7%\",\"2/2\",\"100.0%\",\"2\",\"10\",\"2\",\"6\",\"-3\"],\"started\":\"1\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=4631\",\"onCrt\":\"0\",\"playerId\":\"4631\",\"row\":[\"吉布森\",\"35:48\",\"18\",\"4\",\"1\",\"0\",\"0\",\"8/10\",\"80.0%\",\"0/0\",\"-\",\"2/3\",\"66.7%\",\"1\",\"3\",\"2\",\"1\",\"4\"],\"started\":\"1\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=5546\",\"onCrt\":\"0\",\"playerId\":\"5546\",\"row\":[\"唐斯\",\"37:57\",\"15\",\"11\",\"3\",\"0\",\"1\",\"5/12\",\"41.7%\",\"0/0\",\"-\",\"5/8\",\"62.5%\",\"3\",\"8\",\"1\",\"4\",\"-11\"],\"started\":\"1\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=4624\",\"onCrt\":\"0\",\"playerId\":\"4624\",\"row\":[\"蒂格\",\"31:14\",\"13\",\"5\",\"8\",\"1\",\"0\",\"5/12\",\"41.7%\",\"3/6\",\"50.0%\",\"0/0\",\"-\",\"0\",\"5\",\"0\",\"2\",\"-6\"],\"started\":\"1\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=5292\",\"onCrt\":\"0\",\"playerId\":\"5292\",\"row\":[\"维金斯\",\"38:23\",\"13\",\"7\",\"4\",\"2\",\"0\",\"6/21\",\"28.6%\",\"1/8\",\"12.5%\",\"0/0\",\"-\",\"4\",\"3\",\"4\",\"3\",\"-11\"],\"started\":\"1\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=3407\",\"onCrt\":\"0\",\"playerId\":\"3407\",\"row\":[\"克劳福德\",\"23:44\",\"15\",\"1\",\"4\",\"0\",\"1\",\"7/16\",\"43.8%\",\"1/6\",\"16.7%\",\"0/0\",\"-\",\"1\",\"0\",\"0\",\"2\",\"-9\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=5564\",\"onCrt\":\"0\",\"playerId\":\"5564\",\"row\":[\"琼斯\",\"16:46\",\"5\",\"0\",\"2\",\"0\",\"0\",\"2/5\",\"40.0%\",\"1/2\",\"50.0%\",\"0/0\",\"-\",\"0\",\"0\",\"2\",\"1\",\"-2\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=4912\",\"onCrt\":\"0\",\"playerId\":\"4912\",\"row\":[\"巴特勒\",\"00:00\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"0\",\"0\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=1962937915\",\"onCrt\":\"0\",\"playerId\":\"1962937915\",\"row\":[\"杰弗森\",\"00:00\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"0\",\"0\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=1962937735\",\"onCrt\":\"0\",\"playerId\":\"1962937735\",\"row\":[\"帕顿\",\"00:00\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"0\",\"0\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=5576\",\"onCrt\":\"0\",\"playerId\":\"5576\",\"row\":[\"安东尼-布朗\",\"00:00\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"0\",\"0\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=4387\",\"onCrt\":\"0\",\"playerId\":\"4387\",\"row\":[\"罗斯\",\"00:00\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"0\",\"0\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=5191\",\"onCrt\":\"0\",\"playerId\":\"5191\",\"row\":[\"吉昂\",\"15:47\",\"0\",\"7\",\"0\",\"0\",\"1\",\"0/2\",\"0.0%\",\"0/0\",\"-\",\"0/0\",\"-\",\"2\",\"5\",\"1\",\"3\",\"-2\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=1962937718\",\"onCrt\":\"0\",\"playerId\":\"1962937718\",\"row\":[\"亨特\",\"00:00\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"0\",\"0\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=4726\",\"onCrt\":\"0\",\"playerId\":\"4726\",\"row\":[\"白阿德\",\"00:00\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"0\",\"0\"],\"started\":\"0\"},{\"detailUrl\":\"http://sports.qq.com/kbsweb/kbsshare/player.htm?ref=nbaapp&pid=4304\",\"onCrt\":\"0\",\"playerId\":\"4304\",\"row\":[\"布鲁克斯\",\"00:00\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0/0\",\"-\",\"0/0\",\"-\",\"0/0\",\"-\",\"0\",\"0\",\"0\",\"0\",\"0\"],\"started\":\"0\"},{\"detailUrl\":\"\",\"onCrt\":\"0\",\"playerId\":\"\",\"row\":[\"统计\",\"\",\"109\",\"47\",\"24\",\"3\",\"3\",\"44/94\",\"46.8%\",\"12/31\",\"38.7%\",\"9/13\",\"69.2%\",\"13\",\"34\",\"12\",\"22\",\"-\"],\"started\":\"0\"}],\"text\":\"球员统计\",\"type\":\"15\"}],\"teamInfo\":{\"leftBadge\":\"http://mat1.gtimg.com/chinanba/images/nbateamlogo/126x90/2.png\",\"leftGoal\":\"117\",\"leftId\":\"2\",\"leftName\":\"凯尔特人\",\"leftUrl\":\"http://sports.qq.com/kbsweb/kbsshare/team.htm?ref=nbaapp&cid=100000&tid=2\",\"quarterDesc\":\"第4节 00:00\",\"rightBadge\":\"http://mat1.gtimg.com/chinanba/images/nbateamlogo/126x90/16.png\",\"rightGoal\":\"109\",\"rightId\":\"16\",\"rightName\":\"森林狼\",\"rightUrl\":\"http://sports.qq.com/kbsweb/kbsshare/team.htm?ref=nbaapp&cid=100000&tid=16\"}},\"version\":\"bb3e3e3cadaf6241b0fb81ca7cc27a80\"}";
        //JSONObject jsonObject = JSON.parseObject(str);
        return jsonObject;
    }
}
